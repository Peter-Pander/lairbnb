<!-- app/views/users/edit.html.erb -->
<div class="profile-container" data-controller="photo">
  <!-- Profile Picture Section -->
  <div class="profile-pic-container">
    <% if @user.photo.attached? %>
      <%= image_tag @user.photo, class: "avatar-xxl" %>
    <% else %>
      <%= image_tag "placeholder.png", class: "avatar-xxl" %>
    <% end %>
    <!-- Edit Photo Button triggers hidden file input (via Stimulus) -->
    <button type="button" class="edit-photo-button" data-action="click->photo#editPhoto">
      <i class="fa-solid fa-camera" style="margin-right: 6px;"></i> Edit
    </button>
    <!-- Hidden File Input -->
    <div class="hidden-file-input">
      <%= simple_form_for(@user, url: update_user_profile_path, html: { multipart: true }) do |f| %>
        <%= f.input :photo, as: :file, label: "Upload Profile Picture",
                    input_html: { data: { "photo-target": "fileInput" } } %>
      <% end %>
    </div>
  </div>
  <!-- Profile Info Section -->
  <div class="profile-info-container">
    <h2>Your Profile</h2>
    <!-- Name Field (clickable) -->
    <div class="profile-item clickable" data-bs-toggle="modal" data-bs-target="#editNameModal">
      <strong>Full Name</strong>
      <p class="mb-0"><%= @user.name.presence || "Not provided" %></p>
    </div>
    <hr>
    <!-- Email Field (clickable) -->
    <div class="profile-item clickable" data-bs-toggle="modal" data-bs-target="#editEmailModal">
      <strong>Email</strong>
      <p class="mb-0"><%= @user.email.presence || "Not provided" %></p>
    </div>
    <hr>
  </div>
</div>
<!-- MODALS -->
<!-- Modal for Editing Name -->
<div class="modal fade" id="editNameModal" tabindex="-1" aria-labelledby="editNameModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title" id="editNameModalLabel">What is your name?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <!-- Modal Body: Simple Form for Name -->
      <div class="modal-body">
        <p class="text-muted">
          Tell us what youâ€™d like to be called so others can greet you properly.
          Example: "Selene the Mage," "Groln Ironfist," or "Astrid, retired pirate."
        </p>
        <%= simple_form_for(@user, url: update_user_profile_path, method: :patch) do |f| %>
          <div class="form-group">
            <%= f.input :name,
                        label: false,            # Hide the label
                        placeholder: "Your name",
                        required: false %>
          </div>
          <div class="form-group mt-3">
            <%= f.button :submit, "Save", class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<!-- Modal for Editing Email -->
<div class="modal fade" id="editEmailModal" tabindex="-1" aria-labelledby="editEmailModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title" id="editEmailModalLabel">What is your email address?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <!-- Modal Body: Simple Form for Email -->
      <div class="modal-body">
        <p class="text-muted">
          Provide your email so you can receive important notifications
          (e.g., messages from hosts, quest confirmations, etc.).
        </p>
        <%= simple_form_for(@user, url: update_user_profile_path, method: :patch) do |f| %>
          <div class="form-group">
            <%= f.input :email,
                        label: false,             # Hide the label
                        placeholder: "Your email",
                        required: false %>
          </div>
          <div class="form-group mt-3">
            <%= f.button :submit, "Save", class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
