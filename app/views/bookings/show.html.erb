<div class="confirm-title">
  <h1><strong>Confirm and pay</strong></h1>
</div>
<!-- Wrapper to hold both containers side by side -->
<div class="booking-wrapper">
  <!-- Left Side: Your Trip -->
  <div class="trip-container">
    <!-- Trip announcement -->
    <div class="deal-announcement">
      <p id="deal-text">
        <!-- The random deal will be inserted here -->
      </p>
    </div>
    <script>
      // List of goblin-style deal announcements with "Lower price." at the top
      const deals = [
        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Time is money, friend! ğŸ’¸ Lock in that deal â€˜fore someone else snags it!</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>I got the best deals, anywhere! ğŸ”¥ Ya wonâ€™t find a price like this again!</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Oi! You booking or just window shopping? ğŸ‘€ Get it while it's hot! ğŸ”¥</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Cha-ching! ğŸ’° Best price ya gonna getâ€”donâ€™t wait â€˜til itâ€™s gone! â³</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>A deal so good, itâ€™s almost criminal! ğŸ˜ğŸ’° Hurry up â€˜nâ€™ book it!</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Can I interest ya in a limited-time offer? â³ â€˜Cause this one wonâ€™t last! ğŸš€</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Gold ain't gonna save itself! ğŸ† Lock in this steal before it vanishes! âœ¨</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Ya got good taste, friend! ğŸ˜ Now seal the deal before someone else does! ğŸ”’</span>",

        "<strong class='deal-title'>Lower price.</strong> <span class='money-emoji'>ğŸ’¸</span><br>" +
        "<span>Coinâ€™s talkinâ€™, and it says this is a bargain! ğŸ’° Book now! ğŸƒâ€â™‚ï¸ğŸ’¨</span>"
      ];

      // Pick a random deal
      const randomDeal = deals[Math.floor(Math.random() * deals.length)];

      // Insert the random deal into the page
      document.getElementById("deal-text").innerHTML = randomDeal;
    </script>
    <h4><strong>Your trip</strong></h4>
    <div class="dates-guests">
      <p><strong>Dates</strong></p>
      <p><%= @booking.start_datetime.strftime("%b %-d") %> - <%= @booking.end_datetime.strftime("%b %-d") %></p>
      <br>
      <p><strong>Guests</strong></p>
      <p><%= @booking.guests %> <%= @booking.guests == 1 ? "guest" : "guests" %></p>
      <hr class="thin-line">
    </div>
  </div>
  <!-- Right Side: Price Details -->
  <div class="price-container">
    <!-- New Container for Image and Address -->
    <div class="lair-info-container">
      <div class="lair-info">
        <% if @booking.flat.photo.attached? %>
          <%= image_tag @booking.flat.photo, class: 'lair-image' %>
        <% end %>
        <div class="lair-details">
          <p><strong><%= @booking.flat.name %></strong></p>
          <p class="address">
            <%= @booking.flat.address %>
          </p>
        </div>
      </div>
    </div>
    <hr>
    <p class="price-details-title"><strong>Price details</strong></p>
    <% nights = booking_nights(@booking) %>
    <% total_price = @booking.flat.price_per_night * nights * @booking.guests %>
    <div class="d-flex justify-content-between">
      <p>
        <%= "#{number_to_currency(@booking.flat.price_per_night, unit: '', delimiter: '.', precision: 0)} gold" %>
        x <%= nights %> nights x <%= @booking.guests %>
        <%= @booking.guests == 1 ? "guest" : "guests" %>
      </p>
      <p><strong><%= "#{number_to_currency(total_price, unit: '', delimiter: '.', precision: 0)} gold" %></strong></p>
    </div>
    <hr>
    <div class="d-flex justify-content-between">
      <p><strong>Total</strong></p>
      <p><strong><%= "#{number_to_currency(total_price, unit: '', delimiter: '.', precision: 0)} gold" %></strong></p>
    </div>
  </div>
  <!-- Payment Method Container -->
  <div class="payment-container">
    <h3>Pay with</h3>
    <select class="payment-dropdown">
      <option value="paypal">PayPal</option>
      <option value="visa">Visa</option>
      <option value="mastercard">MasterCard</option>
      <option value="amex">AMEX</option>
      <option value="googlepay">Google Pay</option>
    </select>
    <hr class="thin-line2">
    <h3>Cancellation policy</h3>
    <p class="cancellation-text">This reservation is non-refundable.</p>
  </div>
</div>
<div class="booking-wrapper2">
  <!-- Container for Terms & Conditions -->
  <div class="terms-container booking-wrapper">
    <p class="terms-text">
      By selecting the button below, I agree to the Hostâ€™s Lair Rules, Ground Rules for Guests, LairBnBâ€™s Rebooking and Refund Policy, and I understand that LairBnB may charge my payment method if I am responsible for any damage caused to the lair. Payment Terms between you and LairBnB Payments (Hoard of Treasures Division, Goldclaw Treasury) apply.  </p>
    <p class="terms-text">
      I also agree to the updated Terms of Service, Payment Terms of Service, and acknowledge the Privacy Policy of LairBnB, where personal data is kept safer than a dragonâ€™s hoard.
    </p>
    <button class="goblin-button">Make a Deal! ğŸ’°</button>
  </div>
  <div class="invisible-container"></div>
</div>
